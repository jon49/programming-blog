<html lang="en">
<head>

  
  <meta charset="utf-8">
  <title>Creating a Settings Class in VBA</title>
  <meta name="description" content="Creating a Settings Class in VBA">
  <meta name="author" content="Jon Nyman">

  
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="http://localhost:1313/css/fonts.css">
  
  
  <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
  

    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">

  <link rel="stylesheet" href="http://localhost:1313/css/custom.css">

  
  
  <link rel="stylesheet" href="http://localhost:1313/highlight/styles/default.css">
  
  <script src="http://localhost:1313/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body>


<div class="header pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
    <div class="pure-u-11-12 pure-u-md-5-8">
        <div class="desktop pure-menu pure-menu-horizontal nav-menu">
            
            <a href="/" class="site-title pure-menu-heading">Hamsters Byte</a>
            <ul class="pure-menu-list">
                
                <li class="pure-menu-item">
                    <a href="http://localhost:1313/about/" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
        <div class="mobile pure-menu nav-menu">
            <a href="/" class="pure-menu-heading" id="toggle-home">Hamsters Byte</a>
            <a href="#" id="toggle-btn">&#9776;</a>
            <ul class="pure-menu-list" id="toggle-content" style="display:none;">
                
                
                <li class="pure-menu-item">
                    <a href="http://localhost:1313/about" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>


<div class="pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
	<div class="pure-u-11-12 pure-u-md-5-8">
        <div class="post">

            <div class="post-title">
                <p class="footnote">
                    <time class="">2012-02-29</time>
		            
                    
                    |
                    
                    
                    tags:<a href="http://localhost:1313/tags/vba">vba</a> <a href="http://localhost:1313/tags/settings">settings</a> 
                    

                    

                    
                </p>
                <h1>Creating a Settings Class in VBA</h1>
            </div>

            <div class="post-content">
                <p>In .NET they have a nice settings class you can create using <a href="http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.aspx">ApplicationSettingsBase base class</a>. In VBA it takes a bit more work to get it working, but can be fairly elegant if done correctly.</p>

<p>Some criteria that is needed for a settings class in vba are:
<ul>
    <li>Well formed</li>
    <li>Fast lookup</li>
    <li>Default setting</li>
    <li>Single input/output procedures.</li>
</ul>
To make it well formed I used an <a href="http://www.cpearson.com/excel/Enums.aspx">enumeration variable type</a> to create each setting. I think string constants could accomplish the same thing.</p>

<p>To have a fast look up I use the <a href="http://support.microsoft.com/kb/187234">dictionary object</a>  which<a href="http://www.dotnetperls.com/dictionary-vbnet"> can look up values much faster than</a> the <a href="http://support.microsoft.com/kb/198465">collection object</a>.</p>

<p>Doing default settings is interesting. It took me some time to figure out how to do that. But all that is needed is an optional boolean value for the Get and Let procedures.</p>

<p>A single point to output your values to makes it easy to trouble shoot if something isn&rsquo;t working correctly. Also, the single input is just one procedure that grabs data from where ever you choose to store it and if it isn&rsquo;t stored then it will just grabs the default value.</p>

<p>Here&rsquo;s an example on how a property would look like:</p>

<pre><code class="language-vbscript">'In order to get default value an optional field is needed in the Get and Let procedures.
Public Property Get _
    Example(Optional ByVal bReturnDefault As Boolean = False) _
    As Double
    
    'Uses dictionary for look up of value (loads dictionary when creating new settings class.
    'SettingNames is the enumeration type.
    If mdicSettings.Exists(SettingNames.Example) _
        And Not bReturnDefault Then
    
        Example = CDbl(mdicSettings(SettingNames.Example))
    Else
        Example = 10
    End If
End Property

Public Property Let _
    Example(Optional ByVal bReturnDefault As Boolean = False _
    , ByVal dValue As Double)
    
    'Single point write (all values stored as string).
    'Note that the key is just the integer from the enumeration.
    AddSetting SettingNames.Example, CStr(dValue)
End Property
</code></pre>

            </div>
        </div>
	</div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>

<div class="footer pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
    <div class="pure-u-11-12 pure-u-md-5-8">
        <div class="pure-menu pure-menu-horizontal footer-content">
            <ul>
                <li class="pure-menu-heading" id="foot-name">Jon Nyman:</li>

                

                
                <li class="pure-menu-item">
                    <a href="https://github.com/jon49" class="pure-menu-link">GitHub</a>
                </li>
                

                
                <li class="pure-menu-item">
                    <a href="https://www.linkedin.com/in/eenyman" class="pure-menu-link">LinkedIn</a>
                </li>
                

                

                
                <li class="pure-menu-item">
                    <a href="https://twitter.com/NymanJon" class="pure-menu-link">Twitter</a>
                </li>
                

            </ul>
            <a href="#" class="pure-menu-heading pull-right" id="gototop-btn">↑↑</a>
        </div>
	  </div>
      <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>


<script src="http://localhost:1313/js/jquery.min.js" type="text/javascript"></script>
<script src="http://localhost:1313/js/jquery.timeago.js" type="text/javascript"></script>
<script type="text/javascript">
  $(function(){
    $("time.timeago").timeago();
  })
  $("#toggle-btn").click(function(){
    $("#toggle-content").toggle();
    if($(this).html() === "☰") {
        $(this).html("X")
    } else {
        $(this).html("☰")
    }
  });
  $(window).resize(function(){
    if(window.innerWidth > 768) {
      $(".desktop").removeAttr("style");
    }
  });
</script>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

