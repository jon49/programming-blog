<html lang="en">
<head>

  
  <meta charset="utf-8">
  <title>Prototypes &amp; Compositions with Objects</title>
  <meta name="description" content="Prototypes &amp; Compositions with Objects">
  <meta name="author" content="Jon Nyman">

  
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="http://localhost:1313/css/fonts.css">
  
  
  <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
  

    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">

  <link rel="stylesheet" href="http://localhost:1313/css/custom.css">

  
  
  <link rel="stylesheet" href="http://localhost:1313/highlight/styles/default.css">
  
  <script src="http://localhost:1313/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body>


<div class="header pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
    <div class="pure-u-11-12 pure-u-md-5-8">
        <div class="desktop pure-menu pure-menu-horizontal nav-menu">
            
            <a href="/" class="site-title pure-menu-heading">Hamsters Byte</a>
            <ul class="pure-menu-list">
                
                <li class="pure-menu-item">
                    <a href="http://localhost:1313/about/" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
        <div class="mobile pure-menu nav-menu">
            <a href="/" class="pure-menu-heading" id="toggle-home">Hamsters Byte</a>
            <a href="#" id="toggle-btn">&#9776;</a>
            <ul class="pure-menu-list" id="toggle-content" style="display:none;">
                
                
                <li class="pure-menu-item">
                    <a href="http://localhost:1313/about" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>


<div class="pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
	<div class="pure-u-11-12 pure-u-md-5-8">
        <div class="post">

            <div class="post-title">
                <p class="footnote">
                    <time class="">2014-06-04</time>
		            
                    
                    |
                    
                    
                    tags:<a href="http://localhost:1313/tags/functional-programming">functional programming</a> <a href="http://localhost:1313/tags/design-patterns">design patterns</a> <a href="http://localhost:1313/tags/lenses">lenses</a> 
                    

                    

                    
                </p>
                <h1>Prototypes &amp; Compositions with Objects</h1>
            </div>

            <div class="post-content">
                <p>I was trying to figure out the best way to have functions be both compatible with an object oriented paradigm and a functional oriented paradigm when working on objects. My implementations are probably naive, but instructive nevertheless. It seems that <a href="http://lodash.com/">lo-dash</a> and other libraries have done a good job bridging those worlds.</p>

<p>Let&rsquo;s say you have an object <code>O</code> such that</p>

<pre><code class="language-javascript">function O(a, b){
  this.a = a
  this.b = b
}

var o = function(a, b){
  return new O(a, b)
}
</code></pre>

<p>Now, you want to <code>extend</code> the object but you also want the option to use the object in a more fuctional way with <code>compose</code>.</p>

<p>Let&rsquo;s start with a simple <code>display</code> method.</p>

<pre><code class="language-javascript">var display = function(thisArg){
  var o_ = thisArg || this
  console.log(o_)
  return o_
}
</code></pre>

<p>Then a method to change a property.*</p>

<pre><code class="language-javascript">var change = function(property){
  return function(value, thisArg){
  	var o_ = _.cloneDeep(thisArg || this)
    o_[property] = value
    return o_
  }
}
</code></pre>

<p>Now we can set property to:</p>

<pre><code class="language-javascript">var changeA = change('a')
</code></pre>

<p>Then we can add <code>changeA</code> to the <code>O</code> object and use it.</p>

<pre><code class="language-javascript">O.prototype.changeA = changeA
var o_ = o(1, 2)
o_.changeA(3).display()
</code></pre>

<p>Or we can use a functional approach.</p>

<pre><code class="language-javascript">var o_ = o(1, 2)
_.compose(display, _.curry(changeA)(3))(o_)
//OR
_.compose(display, _.partialRight(changeA, o_))(3)
//OR
_.compose(display, changeA)(3, o_)
</code></pre>

<p>I think I like the functional approach for the more abstract functions and the OO approach as your code becomes more specific. The functional evangelists say the functional style is better because it leads to more reusable code. Which I would agree with, since you are not tying your code up with an object you can then easily extend your model to various other objects, without the use of <code>inheritance</code> and other OO monsters. I think I will use a hybrid approach with <code>bilby.js</code> library which uses polymorphism.</p>

<p>By the way, what I just did with <code>change</code> is similar to <a href="https://github.com/fantasyland/fantasy-lenses"><code>lenses</code></a>.</p>

<p>* An alternative to this would be using a partial function, which would make the original function more flexible.</p>

<pre><code class="language-javascript">var change = function(property, value, thisArg){
  	var o_ = _.cloneDeep(thisArg || this)
    o_[property] = value
    return o_
  }
}
</code></pre>

<p>Now we can set property to:</p>

<pre><code class="language-javascript">var changeA = _.partial(change, 'a')
</code></pre>

<p>Or using combinators (not strict).</p>

<pre><code class="language-javascript">var set = function(property, value){
  this[property] = value
  return this
}

var change = function(f, value, thisArg){
  	var o_ = _.cloneDeep(thisArg || this)
    o_ = f.apply(o_, [value])
    return o_
  }
}
</code></pre>

<p>Now we can set property to:</p>

<pre><code class="language-javascript">var changeA = _.partial(change
              , _.partial(set, 'a'))
</code></pre>

            </div>
        </div>
	</div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>

<div class="footer pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
    <div class="pure-u-11-12 pure-u-md-5-8">
        <div class="pure-menu pure-menu-horizontal footer-content">
            <ul>
                <li class="pure-menu-heading" id="foot-name">Jon Nyman:</li>

                

                
                <li class="pure-menu-item">
                    <a href="https://github.com/jon49" class="pure-menu-link">GitHub</a>
                </li>
                

                
                <li class="pure-menu-item">
                    <a href="https://www.linkedin.com/in/eenyman" class="pure-menu-link">LinkedIn</a>
                </li>
                

                

                
                <li class="pure-menu-item">
                    <a href="https://twitter.com/NymanJon" class="pure-menu-link">Twitter</a>
                </li>
                

            </ul>
            <a href="#" class="pure-menu-heading pull-right" id="gototop-btn">↑↑</a>
        </div>
	  </div>
      <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>


<script src="http://localhost:1313/js/jquery.min.js" type="text/javascript"></script>
<script src="http://localhost:1313/js/jquery.timeago.js" type="text/javascript"></script>
<script type="text/javascript">
  $(function(){
    $("time.timeago").timeago();
  })
  $("#toggle-btn").click(function(){
    $("#toggle-content").toggle();
    if($(this).html() === "☰") {
        $(this).html("X")
    } else {
        $(this).html("☰")
    }
  });
  $(window).resize(function(){
    if(window.innerWidth > 768) {
      $(".desktop").removeAttr("style");
    }
  });
</script>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

